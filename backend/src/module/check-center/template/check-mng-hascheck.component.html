<fc-notice #notice ot="确认"></fc-notice>
<div class="CheckMngList">
	<div class="page-content-header icon-order-manageOn">已审批列表</div>
	<div class="page-content">
		<div class="table-container">
			<div class="search-container">
				<input type="text" class="form-control searchbox gray-searchbox" placeholder="输入订单信息快速查询"/>
				<span class="glyphicon glyphicon-search searchbox-incon" (click)="search()"></span>
						
				<button class="fox-cloud-button float-left "  [ngClass]="{'fox-cloud-button-white':_isAdvSearch==1,'fox-cloud-button-grey':_isAdvSearch!=1}" (click)="_isAdvSearch = !_isAdvSearch">
					  <span class="icon-button-label pointer">高级查询</span>
				</button>
		</div>
			<table class="table" *ngIf="_isAdvSearch">
				<tbody>
					<tr>				
						<td >
						    <div class="float-left font-size-16 mgt8 mgr5">订单归属：<span class="mgt8 mgl10 mgr5">企业</span></div>
							<div class="float-left">
								<select class="form-control  select_" [(ngModel)]="_param.entIdStr" (ngModelChange)="entChanged()">
									<option class="hands" [value]="null">所有企业</option>
									<option class="hands" *ngFor="let item of _entLoader.Items" [value]="item.id">{{item.name}}</option>
								</select>
							</div>
						</td>
						<td><div class="float-left font-size-16 mgl22 mgt8 mgr15">部门</div>

							<div class="float-left">
								<select class="form-control" [(ngModel)]="_param.departmentIdNum" (ngModelChange)="departmentChanged()">
									<option class="hands" [value]="null">所有部门</option>
									<option class="hands" *ngFor="let item of _departmentLoader.Items" [value]="item.id">{{item.name}}</option>
								</select>
							</div>
						</td>
						<td ><div class="float-left font-size-16 mgt8 mgr15">提交者</div>
							<div class="float-left">
								<select class="form-control" [(ngModel)]="_param.submitUserId">
									<option class="hands" [value]="null">所有提交者</option>
									<option class="hands" *ngFor="let item of _userListLoader.Items" [value]="item.id">{{item.name}}</option>
								</select>
							</div>

						</td>
					</tr>
					<tr class="bgWhite">
						<td ><div class="float-left font-size-16  mgt8">订单类型：</div>
								<div class="float-left">
								<select class="form-control" [(ngModel)]="_param.orderTypeNum">
									<option class="hands" [value]="null">所有订单</option>
									<option class="hands" *ngFor="let item of _orderTypeDic.Items" [value]="item.value">{{item.displayValue}}</option>
								</select>
							</div>
						</td>
						<td><div class="float-left font-size-16 mgt8">产品类型：</div>
							<div class="float-left">
								<select class="form-control" [(ngModel)]="_param.serviceTypeNum">
									<option class="hands" [value]="null">所有类型</option>
									<option class="hands" *ngFor="let item of _serviceTypeDic.Items" [value]="item.value">{{item.displayValue}}</option>
								</select>
							</div>
						</td>
						<td><div class="float-left font-size-16 mgt8">审批人：</div>
							<div class="dropdown float-left">
								<select class="form-control" [(ngModel)]="_param.checkUserIdStr">
									<option class="hands" [value]="null">所有用户</option>
									<option class="hands" *ngFor="let item of _approverListLoader.Items" [value]="item.id">{{item.name}}</option>
								</select>
							</div>
						</td>
					</tr>
					<tr>
						<td><div class="float-left font-size-16 pdt10  mgt8">开始时间：</div>
							<div class="float-left">			
								<date-picker (dateChanged)="onStartDateChange($event)"></date-picker>
							</div>

						</td>
						<td ><div class="float-left font-size-16  pdt10 mgt8">结束时间：</div>
							<div class="float-left">			
								<date-picker (dateChanged)="onEndDateChange($event)"></date-picker>
							</div>
						</td>
						<td>

							<div style="margin-left: 115px;text-align:left!important;">
								<button class="fox-cloud-button-sm  fox-cloud-button-white mgr20" (click)="resetParam()">重&nbsp;&nbsp;&nbsp;&nbsp;置</button><button class="fox-cloud-button-sm  fox-cloud-button-white mgl20" (click)="search()">查&nbsp;&nbsp;&nbsp;&nbsp;询</button>
							</div>
						</td>
					</tr>
				</tbody>
			</table>	
		</div>
		<div class="mgb10 float-left">当前查询到{{_listLoader.TotalRecords}}个订单需要审批，查询结果如下：</div>
			<div class="table-container">
			<table class="table table-hover border-gray">
				<thead>	
					<tr class="border-gray">
						<th>编号</th>
						<th>订单号</th>
						<th>产品类型</th>
						<th>所在区域及可用区</th>
						<th>订单类型</th>
						<th>订单描述</th>
						<th>提交者</th>
						<th>部门</th>
						<th>企业</th>
						<th>费用</th>
						<th>创建时间</th>
						<th>审批结果</th>
					</tr>			
				</thead>
				<tbody>
					<tr class="border-gray" *ngFor="let item of _listLoader.Items;let i=index;">
						<td>{{i + 1}}</td>
						<td>{{item.orderCodeStr}}<br>
							<a [popover]="myPopover" class="hands">详细信息>>>></a>
							<popover-content #myPopover 
								placement="right"
								[animation]="true" 
								[closeOnClickOutside]="true" >
								<ul>
									<li *ngFor="let spec of item.specList">{{spec.attrDisplayName}}:{{spec.attrDisplayValue}}</li>
								</ul>
						</popover-content>
					    </td>
						<td>{{item.serviceTypeName}}</td>
						<td>{{item.platformStr}}<br/>
						    {{item.zoneStr}}</td>
						<td>{{item.orderTypeName}}</td>
						<td>{{item.description}}</td>
						<td>{{item.userStr}}</td>
						<td>{{item.departmentStr}}</td>
						<td>{{item.entStr}}</td>
						<td>计费模式：{{item.billingModeName}}
							<br/>订单周期：{{item.billingDurationStr}}
							<br/>一次性费用：{{item.oneTimePriceNum}}
							<br/>费用：{{item.priceNum}}
						</td>
						<td>{{item.createTimeStr}}<br>
							<a class="hands" [popover]="checkPopover">审批详细>>>></a>

							<popover-content #checkPopover 
							placement="left"
							[animation]="true" 
							[closeOnClickOutside]="true" >

								<ul *ngFor="let approveItem of item.checkResult | async">
									<li>审批人：&nbsp;&nbsp;{{approveItem.approver}}</li>
									<li>审批时间：&nbsp;&nbsp;{{approveItem.operateTime}}</li>
									<li>审批意见：&nbsp;&nbsp;{{approveItem.reason}}</li>			
								</ul>

						</popover-content>

						</td>
						<td>
							<ul>
								<li *ngFor="let approveItem of item.checkResult | async">{{approveItem.reason}}</li>
							</ul>
						</td>
						<!-- <td>{{item.checkResultName}}</td> -->
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>