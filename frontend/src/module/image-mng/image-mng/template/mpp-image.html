<div class="page-content cloud_mirror">
    <div class="col-md-12">
        <h1 class="page-content-header">镜像</h1>
        <ul class="left-box-mirror" style="margin-bottom:20px;">
            <li>
                <div class="col-md-2 li-title">
                    <p><br>区域列表</p>
                </div>
                <div class="col-md-12 li-content">
                    <div class="col-md-12 btn-group" data-toggle="buttons">
                        <label class="btn btn-default fix-width-140" [ngClass]="{'active':queryOpt.areaList == ''}" (click)="queryOpt.areaId=''">
                            <input type="radio" name="location" [checked]="queryOpt.areaList == ''" autocomplete="off"> 所有
                        </label>
                        <label *ngFor="let area of areaList;" class="btn btn-default fix-width-140" title="{{area.name}}" [ngClass]="{'active':queryOpt.areaId == area.id}" (click)="queryOpt.areaId = area.id;">
                            <input type="radio" name="location" autocomplete="off" [checked]="queryOpt.areaList == area.id">{{area.name}}
                        </label>
                    </div>
                </div>
            </li>
            <li>
                <div class="col-md-2 li-title">
                    <p><br>镜像归属</p>
                </div>
                <div class="col-md-12 li-content">
                    <div class="col-md-12 btn-group" data-toggle="buttons">
                        <label class="btn btn-default fix-width-140" [ngClass]="{'active':queryOpt.imageOwner == ''}" (click)="queryOpt.imageOwner=''">
                            <input type="radio" name="location" checked="checked" autocomplete="off"> 所有
                        </label>
                        <label *ngFor="let o of this.service.ownerDic | async;" class="btn btn-default fix-width-140" title="{{o.displayValue}}" [ngClass]="{'active':queryOpt.imageOwner == o.value}" (click)="queryOpt.imageOwner = o.value">
                            <input type="radio" name="owner" autocomplete="off" [checked]="queryOpt.imageOwner == o.value" /> {{o.displayValue}}
                        </label>
                    </div>
                </div>
            </li>
        </ul>

        <div class="pull-left row" style="margin-bottom:20px;">
            <div class="col-md-1">
                <select class="form-control" (change)="setKeyword(type.value,keyword.value)" #type>
                    <option value="0" selected="selected">镜像名称</option>
                    <option value="1">操作系统</option>
                </select>
            </div>
            <div class="input-group col-md-2 float-left">
                <input class="form-control" placeholder="输入镜像信息搜索" [(ngModel)]="queryOpt.osAndName" (change)="setKeyword(type.value,keyword.value)" #keyword>
                <div class="input-group-addon">
                    <span class="glyphicon glyphicon-search"></span>
                </div>
            </div>

            <!--<span class="float-left" style="margin-left:10px;margin-top:6px;">状态 :</span>
            <div class="col-md-2 float-left">
                <select class="form-control" [(ngModel)]="queryOpt.status">
                    <option [value]="" value="">所有</option>
                    <option *ngFor="let stauts of this.service.statusDic | async" [value]="stauts.value">{{stauts.displayValue}}</option>
                </select>
            </div>-->

            <span class="pull-left mgt10 mgl15">镜像类型 :</span>
            <div class="col-md-2">
                <select class="form-control" [(ngModel)]="queryOpt.imageType">
                    <option [value]="" value="">所有</option>
                    <option *ngFor="let type of this.service.typeDic | async;" [value]="type.value">{{type.displayValue}}</option>
                </select>
            </div>

            <button class="btn button-gray-gradient" (click)="search()"><span class="glyphicon glyphicon-search"></span> 简单搜索</button>
            <button class="btn button-gray-gradient" (click)="resetQueryOpt()"><span class="glyphicon glyphicon-repeat"></span> 重置选项</button>
            <!--<button class="btn button-gray-gradient pull-right" style="margin-right:15px;">
                <span class="icon icon-link"></span> 相关实例
            </button>
            -->
        </div>
        <table class="table table-hover mgb20" style="table-layout:fixed">
            <thead>
                <tr>
                    <th class="text-center" style="width:47px">选择</th>
                    <th class="text-center">镜像名称</th>
                    <th class="text-center">镜像类型</th>
                    <th class="text-center">操作系统</th>
                    <th class="text-center">系统位数</th>
                    <th class="text-center">镜像容量</th>  <!--新增镜像容量，删除状态列-->
                    <th class="text-center">创建人</th>
                    <th class="text-center">创建部门</th>
                    <th class="text-center">创建时间</th>
                    <th class="text-center">进度</th>
                    <th class="text-center">描述</th>
                    <th class="text-center">操作</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let image of images">
                    <td class="text-center">
                        <input type="radio" class="fox-cloud-radio" name="group-image" [checked]="image.selected" (change)="image.selected = $event.target.checked" />
                    </td>
                    <td class="text-center" style="word-wrap:break-word">{{image.name}}  </td>
                    <td class="text-center">
                        {{image.type | dict:this.service.typeDic | async}}
                    </td>
                    <td class="text-center">{{image.os | dict:this.service.osDic | async}}</td>
                    <td class="text-center">
                        {{image.bits | dict:this.service.bitDic | async}}
                    </td>
                    <td class="text-center">{{ image.capacity | formatCapacity}}</td>
                    <td class="text-center" style="word-wrap:break-word">{{image.creatorName}}</td>
                    <td class="text-center" style="word-wrap:break-word">{{image.orgName}}</td>
                    <td class="text-center">{{image.createTime}} </td>
                    <td class="text-center">{{image.progress}}%</td>
                    <td class="text-center " style="word-wrap:break-word">{{image.description}}</td>
                    <td class="text-center">
                        <div *ngIf="image.type !=0">
                            <span class="icon icon-edit2 pointer" (click)="openEidtPanel(image);" style="padding: 1px 10px"></span>
                            <span class="icon icon-link pointer" style="padding: 1px 12px"></span>
                            <span class="icon icon-delete3 pointer" (click)="deleteImage(image);" style="padding: 1px 10px"></span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="fox-cloud-pagination-container">
            <fc-pagination #pager tp={{totalPage}} (pf)="getImageList($event)"></fc-pagination>
        </div>
        <fc-notice #notice title="{{noticeTitle}}" msg="{{noticeMsg}}" ot="确认"></fc-notice>
        <fc-confirm #confirm title="{{noticeTitle}}" msg="{{noticeMsg}}" ot="确认" ct="取消"></fc-confirm>

    </div>
</div>

<fc-popup #editPopup title="{{title}}" ot="保存" (of)="updateImage();" ct="关闭" (cf)="ccf()">
    <div class="row row-line-height">
        <div class="form-group">
            <div class="col-sm-4 form-control-title"><span class="asterisk">*</span>自定义镜像名:</div>
            <div class="col-sm-7">
                <input type="text" class="form-control" placeholder="" [(ngModel)]="editImage.name">
                <div>2-68个字符，以大小写字母或中文开头，可包含数字，"."，"-"，"_"</div>
            </div>
        </div>
    </div>
    <div class="row row-line-height">
        <div class="form-group">
            <div class="col-sm-4 form-control-title"><span class="asterisk">*</span>自定义镜像应用范围:</div>
            <div class="col-sm-7 " style="line-height:34px">
                <label *ngFor="let o of ownerDic;" class="pdr10">
                    <input class="fox-cloud-radio" [checked]="editImage.imageOwner==o.value" type="radio" name="editImage.imageOwner" (change)="editImage.imageOwner = o.value">
                </label>
            </div>

        </div>
    </div>
    <div class="row row-line-height">
        <div class="form-group">
            <div class="col-sm-4 form-control-title">自定义镜像描述:</div>
            <div class="col-sm-7">
                <textarea class="form-control" rows="3" [(ngModel)]="editImage.description"></textarea>
                <div>长度为2-256个字符 </div>
            </div>
        </div>
    </div>
</fc-popup>
