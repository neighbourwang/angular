<div class="page-content cloud_host_list">
	<h1 class="page-content-header">{{options.title | translate}}</h1>

    <table class="cm-table-left top-table mgb20">
        <tr>
            <th class="col-md-1 col-xs-3 text-center">{{'VM_INSTANCE.REGION_LIST' | translate}}</th>
            <td>
                <platform-zone #platformZone (onClick)="platformClick($event)"></platform-zone>
            </td>
        </tr>
        <!--<tr>
            <th class="col-md-1 col-xs-3 text-center">实例归属</th>
            <td>
                <div class="col-md-10 btn-group" data-toggle="buttons">
                    <button (click)="list.ownerType = ''" class="btn btn-default" [ngClass]="{'active':list.ownerType === ''}">所有</button>

                    <button *ngFor="let v of service.ownerType | async;" 
                            (click)="list.ownerType = v.code" 
                            [ngClass]="{'active':list.ownerType === v.code}"
                            class="btn btn-default">{{ v.displayValue }}
                    </button>
                </div>
            </td>
        </tr>
        <tr>
            <th class="col-md-1 col-xs-3 text-center">标　　签</th>
            <td>
                <div class="col-md-10 btn-group">
                    <button (click)="list.labelId = ''" class="btn btn-default" [ngClass]="{'active':list.labelId === ''}">所有</button>
                    
                    <button *ngFor="let value of labelItem;" 
                            (click)="list.labelId = value.labelId" 
                            [ngClass]="{'active':list.labelId === value.labelId}"
                            class="btn btn-default">{{ value.labelDisplayName }}
                    </button>
                </div>
            </td>
        </tr>-->
    </table>
    <div class="col-md-12 no-padding mgb20">
        <div class="dropdown float-left mgr10">
            <select [(ngModel)]="list.queryField" class="form-control">
                <option
                 *ngFor="let v of service.queryField | async; let i = index;"
                 [ngValue]="v.code" >{{ v.displayValue }}</option>
            </select>
        </div>
         <div class="input-group col-md-1 float-left mgr10" *ngIf="superSearch">
            <select class="form-control"  [(ngModel)]="list.status"> 
                <option disabled selected value class="hideoption">{{'COMMON.STATUS' | translate}}</option>
                <option
                 *ngFor="let v of service.computeStatus | async; let i = index;"
                 [ngValue]="v.code" >{{ v.displayValue }}</option>
            </select>
         </div>
         <div class="input-group col-md-1 float-left mgr10" *ngIf="superSearch">
            <select class="form-control"  [(ngModel)]="list.addonType"> 
                <option disabled selected value class="hideoption">{{'VM_INSTANCE.EXTRA_SERVICES' | translate}}</option>
                <option
                 *ngFor="let v of service.addonType | async; let i = index;"
                 [ngValue]="v.code" >{{ v.displayValue }}</option>
            </select>
         </div>
         <div class="input-group col-md-1 float-left mgr10" *ngIf="superSearch">
            <select class="form-control"  [(ngModel)]="list.useType"> 
                <option disabled selected value class="hideoption">{{'COMMON.TYPE' | translate}}</option>
                <option
                 *ngFor="let v of service.useType | async; let i = index;"
                 [ngValue]="v.code" >{{ v.displayValue }}</option>
            </select>
         </div>
         <div class="input-group col-md-1 float-left mgr10" *ngIf="superSearch">
            <select class="form-control"  [(ngModel)]="list.serviceLevel"> 
                <option disabled selected value class="hideoption">{{'VM_INSTANCE.SERVICE_LEVEL' | translate}}</option>
                <option
                 *ngFor="let v of service.serviceLevel | async; let i = index;"
                 [ngValue]="v.code" >{{ v.displayValue }}</option>
            </select>
         </div>
        <div class="input-group col-md-2 float-left mgr10">
            <input class="form-control width-100" [(ngModel)]="list.queryFieldValue" type="email" placeholder="{{'COMMON.ENTER_CLOUD_HOST_INFORMATION_TO_SEARCH' | translate}}">
            <div class="input-group-addon"  (click)="search()"><span class="glyphicon glyphicon-search"></span></div>
        </div>
        <!-- <div class="input-group float-left mgr10">
            <label class="btn btn-default button-gray-gradient" (click)="superSearch = !superSearch" [ngClass]="{'active': superSearch}">
                高级搜索
            </label>
        </div> -->
        <div class="input-group float-left">
            <button (click)="resetSearch()" class="btn button-gray-gradient"><span class="glyphicon glyphicon-repeat"></span> {{'COMMON.RESET_SEARCH' | translate}}</button>
        </div>
    </div>
    <div class="col-md-12 no-padding mgb20">
        <button class="btn float-left mgr5 btn-primary" (click)="goTo('cloud-host-service/cloud-host-order')"><i class="glyphicon glyphicon-plus"></i> {{'VM_INSTANCE.CREATE_CLOUD_HOST' | translate}}</button>
        <!-- <button class="btn float-left mgr5 btn-success"><i class="glyphicon glyphicon-edit"></i> 编辑云主机</button> -->
        <button (click)="delectVm()" class="btn float-left mgr5 btn-danger"><i class="glyphicon glyphicon-trash"></i> {{'VM_INSTANCE.UNSUBSCRIBE_CLOUD_HOST' | translate}}</button>

        <!--<div class="dropdown float-left  mgr5">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            更多操作
            <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
                <li><a href="javascript:">挂载</a></li>
                <li><a href="javascript:">卸载</a></li>
                <li><a href="javascript:">备份</a></li>
            </ul>
        </div>-->
    </div>

    <table class="table table-hover">
        <tr>
            <th class="text-center"></th>
            <th class="text-center">{{'COMMON.CLOUD_HOST_NAME'| translate}}</th>
            <th class="text-center">{{'COMMON.CONFIGURATION'| translate}}</th>
            <th class="text-center">{{'VM_INSTANCE.MIRROR' | translate}}</th>
            <th class="text-center">{{'VM_INSTANCE.INTERNAL_IP' | translate}}</th> 
            <th class="text-center">{{'VM_INSTANCE.EXTERNA_IP' | translate}}</th>
            <th class="text-center">{{'COMMON.REGION_AND_AVAILABLE_AREA' | translate}}</th>
            <th class="text-center">{{'COMMON.STATUS'| translate}}</th>
            <th class="text-center">{{'COMMON.EXPIRE_DATE'| translate}}</th>
            <!--<th class="text-center">云硬盘数</th> -->
            <!--<th class="text-center">快照数</th>-->
            <!-- <th class="text-center">附加服务</th> -->
            <!-- <th class="text-center">类型</th> -->
            <!-- <th class="text-center">服务类别</th> -->
            <th class="text-center">{{'COMMON.OPERATION'| translate}}</th> 
        </tr>
        <tr *ngFor="let vm of vmList;let i = index;" style="line-height: 65px;">
            <td class="text-center"> <input type="radio" class="fox-cloud-radio" (change)="radioSelected=vm;"  name="host-list"></td>
            <!-- <td class="text-center active" style="position: relative;width: 220px;">
                <table-edit-name [value]="vm.instanceName" (onChange)="changeName($event)"></table-edit-name>
            </td> -->
            <td class="text-center active">{{vm.instanceName}}</td>
            <td class="text-center">{{vm.specification}}</td>
            <td class="text-center">{{vm.osInfo}}</td>
            <td class="text-center">{{vm.privateIP}}</td> 
            <td class="text-center">{{vm.publicIP}}</td>
            <td class="text-center">{{vm.regionZone}}</td>
            <td class="text-center">{{vm.vmState | dict:service.computeStatus | async}}</td>
            <td class="text-center">{{vm.expiryDate}}</td>
            <!--<td class="text-center">{{vm.diskCount}}</td> -->
            <!--<td class="text-center">{{vm.snapshotCount}}</td>-->
            <!-- <td class="text-center">无</td> -->
            <!-- <td class="text-center">生产</td> -->
            <!-- <td class="text-center">关键</td> -->
            <td class="text-center">
                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" [attr.id]="'dropdownMenu'+(index+3)" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    {{'COMMON.MORE_ACTIONS'| translate}}
                    <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a *ngIf="['14'].indexOf(vm.vmState) > -1" (click)="handleVm('start', vm, '启动')" href="javascript:">{{'COMMON.START'| translate}}</a></li>
                        <li><a *ngIf="['0'].indexOf(vm.vmState) > -1" (click)="handleVm('stop', vm, '关机')" href="javascript:">{{'COMMON.SHUTDOWN'| translate}}</a></li>
                        <!-- <li><a (click)="handleVm('stop', vm)" href="javascript:">停止</a></li> -->
                        <li><a *ngIf="['0'].indexOf(vm.vmState) > -1" (click)="handleVm('pause', vm, '暂停')" href="javascript:">{{'COMMON.PAUSE'| translate}}</a></li>
                        <li><a *ngIf="['7'].indexOf(vm.vmState) > -1" (click)="handleVm('unpause', vm , '恢复')" href="javascript:">{{'COMMON.RESTORE'| translate}}</a></li>
                        <!-- <li><a (click)="handleVm('resume', vm)" href="javascript:">恢复</a></li> -->
                        <li><a *ngIf="['0','14'].indexOf(vm.vmState) > -1" (click)="handleVm('hardReboot', vm , '硬重启')" href="javascript:">{{'COMMON.HARD_REBOOT'| translate}}</a></li>
                        <li><a *ngIf="['0','14'].indexOf(vm.vmState) > -1" (click)="handleVm('softReboot', vm , '软重启')" href="javascript:">{{'COMMON.SOFT_RESTART'| translate}}</a></li>
                        <li><a *ngIf="['0'].indexOf(vm.vmState) > -1 && vm.publicIP && vm.platformType === '0'" (click)="handleVm('unbindFloatingIp', vm, '解绑浮动IP')" href="javascript:">{{'VM_INSTANCE.UNBIND_FLOATING_IP'| translate}}</a></li>
                        <!-- <li><a (click)="handleVm('suspend', vm)" href="javascript:">挂起</a></li> -->
                        <li><a *ngIf="['0','14','7'].indexOf(vm.vmState) > -1 && !vm.publicIP && vm.platformType === '0'" (click)="handleVm('bindFloatingIp', vm, '绑定浮动IP')" href="javascript:">{{'VM_INSTANCE.BIND_FLOATING_IP'| translate}}</a></li>
                        <li><a *ngIf="['0','14','7'].indexOf(vm.vmState) > -1" (click)="openConsole(vm)" href="javascript:">{{'VM_INSTANCE.VIEW_CONSOLE'| translate}}</a></li>
                    </ul>
                </div>
            </td> 
        </tr>
    </table>
    <fc-pagination tp={{list.pageParameter.totalPage}} (pf)="changePage($event)"></fc-pagination>
</div>
<fc-confirm #confirm title="{{modalTitle}}" msg="{{modalMessage}}" ot="{{modalOKTitle}}" (of)="modalAction(1)" ct="{{modalCancelTitle}}" (cf)="modalAction(0)"></fc-confirm>
<fc-notice #notice title="{{modalTitle}}" msg="{{modalMessage}}" ot="{{modalOKTitle}}" (of)="modalAction(0)"></fc-notice>
<fc-popup #popup (cf)="popupCf()" (of)="popupOf()">
    <div style="text-align: center;"><input [(ngModel)]="forceDelect" type="checkbox" name=""> {{'VM_INSTANCE.UNSUBSRIBE_ALL_DISK'| translate}} "{{radioSelected.instanceName}}"</div>
</fc-popup>
